<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>魔戒TRPG - 自动人物卡生成器</title>
        <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>

<div class="character-sheet">
    <div class="grid-container">
        <div class="main-left">
            <div class="header-info">
                <div class="identity-group">
                    <div class="info-item char-name"><label for="char_name">角色姓名</label><input type="text" id="char_name" name="char_name"></div>
                    <div class="info-item heroic-culture">
                        <label for="heroic_culture">英雄所属文化</label>
                        <select id="heroic_culture" name="heroic_culture">
                            <option value="">--请选择文化--</option>
                            <option value="巴德一族的人类">巴德一族的人类</option>
                            <option value="都林一族的矮人">都林一族的矮人</option>
                            <option value="林顿的精灵">林顿的精灵</option>
                            <option value="夏尔的霍比特人">夏尔的霍比特人</option>
                            <option value="布理的人类">布理的人类</option>
                            <option value="北方的游民">北方的游民</option>
                        </select>
                    </div>
                    <div class="info-item cultural-blessing">
                        <label for="cultural_blessing">文化赐福</label>
                        <input type="text" id="cultural_blessing" name="cultural_blessing" class="readonly" readonly>
                        <div class="description-box" id="cultural_blessing_desc"></div>
                    </div>
                </div>

                <div class="second-column-group">
                    <div class="info-row calling-treasure-row">
                        <div class="info-item calling">
                            <label for="calling">呼召</label>
                            <select id="calling" name="calling">
                                <option value="">--请选择呼召--</option>
                                <option value="领袖">领袖</option>
                                <option value="勇士">勇士</option>
                                <option value="信使">信使</option>
                                <option value="学者">学者</option>
                                <option value="寻宝客">寻宝客</option>
                                <option value="守望者">守望者</option>
                            </select>
                        </div>
                        <div class="info-item char-treasure"><label for="char_treasure">宝藏</label><input type="text" id="char_treasure" name="char_treasure"></div>
                    </div>
                    <div class="info-row age-living-row">
                        <div class="info-item char-age"><label for="char_age">年龄</label><input type="text" id="char_age" name="char_age"></div>
                        <div class="info-item char-living-standard"><label for="char_living_standard">生活水平</label><input type="text" id="char_living_standard" name="char_living_standard" class="readonly" readonly></div>
                    </div>
                    <div class="info-row patron-shadow-row">
                        <div class="info-item char-patron"><label for="patron">赞助人</label><input type="text" id="patron" name="patron"></div>
                        <div class="info-item shadow-path"><label for="shadow_path">魔影之路</label><input type="text" id="shadow_path" name="shadow_path"></div>
                    </div>
                </div>

                <div id="personal_traits_section">
                    <div class="trait-box trait1-item">
                        <label for="trait1_select">文化特质 1</label>
                        <select id="trait1_select" name="trait1_select" disabled>
                            <option value="">--先选择文化--</option>
                        </select>
                        <div class="description-box" id="trait1_desc"></div>
                    </div>
                    <div class="trait-box trait2-item">
                        <label for="trait2_select">文化特质 2</label>
                        <select id="trait2_select" name="trait2_select" disabled>
                            <option value="">--先选择文化--</option>
                        </select>
                        <div class="description-box" id="trait2_desc"></div>
                    </div>
                    <div class="trait-box trait3-item">
                        <label for="trait3_calling_feature">职业特性</label>
                        <input type="text" id="trait3_calling_feature" name="trait3_calling_feature" class="readonly" readonly>
                        <div class="description-box" id="trait3_desc">由您的职业决定。</div>
                    </div>
                </div>

                <div class="attributes-section">
                    <div style="grid-column: span 1;">
                        <div class="diamond-box">
                            <div class="diamond-content">
                                <div class="attr-title">体魄</div>
                                <div class="attr-tn"><label for="body_tn">TN</label><input type="number" id="body_tn" name="body_tn" min="0" max="20"></div>
                                <div class="attr-val"><label for="body_val">数值</label><input type="number" id="body_val" name="body_val" min="0" max="20" value="0"></div>
                                <div class="attr-derived">耐力上限: <span id="endurance_val">0</span></div>
                            </div>
                        </div>
                    </div>

                    <div style="grid-column: span 1;">
                        <div class="diamond-box">
                            <div class="diamond-content">
                                <div class="attr-title">心志</div>
                                <div class="attr-tn"><label for="heart_tn">TN</label><input type="number" id="heart_tn" name="heart_tn" min="0" max="20"></div>
                                <div class="attr-val"><label for="heart_val">数值</label><input type="number" id="heart_val" name="heart_val" min="0" max="20" value="0"></div>
                                <div class="attr-derived">希望上限: <span id="hope_val">0</span></div>
                            </div>
                        </div>
                    </div>

                    <div style="grid-column: span 1;">
                        <div class="diamond-box">
                            <div class="diamond-content">
                                <div class="attr-title">才智</div>
                                <div class="attr-tn"><label for="wits_tn">TN</label><input type="number" id="wits_tn" name="wits_tn" min="0" max="20"></div>
                                <div class="attr-val"><label for="wits_val">数值</label><input type="number" id="wits_val" name="wits_val" min="0" max="20" value="0"></div>
                                <div class="attr-derived">招架: <span id="parry_val">0</span></div>
                            </div>
                        </div>
                    </div>
                </div>
        </div>

        <div class="skills-section">
            <div class="skills-column">
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_awe" name="spec_awe"><label for="spec_awe"></label></div><label class="skill-name-label">威慑</label><div class="skill-ranks" id="skill_awe"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_athletics" name="spec_athletics"><label for="spec_athletics"></label></div><label class="skill-name-label">运动</label><div class="skill-ranks" id="skill_athletics"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_awareness" name="spec_awareness"><label for="spec_awareness"></label></div><label class="skill-name-label">觉察</label><div class="skill-ranks" id="skill_awareness"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_hunting" name="spec_hunting"><label for="spec_hunting"></label></div><label class="skill-name-label">狩猎</label><div class="skill-ranks" id="skill_hunting"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_song" name="spec_song"><label for="spec_song"></label></div><label class="skill-name-label">歌唱</label><div class="skill-ranks" id="skill_song"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_craft" name="spec_craft"><label for="spec_craft"></label></div><label class="skill-name-label">手艺</label><div class="skill-ranks" id="skill_craft"></div></div>
            </div>
            <div class="skills-column">
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_enhearten" name="spec_enhearten"><label for="spec_enhearten"></label></div><label class="skill-name-label">鼓舞</label><div class="skill-ranks" id="skill_enhearten"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_travel" name="spec_travel"><label for="spec_travel"></label></div><label class="skill-name-label">旅行</label><div class="skill-ranks" id="skill_travel"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_insight" name="spec_insight"><label for="spec_insight"></label></div><label class="skill-name-label">洞悉</label><div class="skill-ranks" id="skill_insight"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_healing" name="spec_healing"><label for="spec_healing"></label></div><label class="skill-name-label">医疗</label><div class="skill-ranks" id="skill_healing"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_courtesy" name="spec_courtesy"><label for="spec_courtesy"></label></div><label class="skill-name-label">礼仪</label><div class="skill-ranks" id="skill_courtesy"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_battle" name="spec_battle"><label for="spec_battle"></label></div><label class="skill-name-label">作战</label><div class="skill-ranks" id="skill_battle"></div></div>
            </div>
            <div class="skills-column">
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_persuade" name="spec_persuade"><label for="spec_persuade"></label></div><label class="skill-name-label">说服</label><div class="skill-ranks" id="skill_persuade"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_stealth" name="spec_stealth"><label for="spec_stealth"></label></div><label class="skill-name-label">潜行</label><div class="skill-ranks" id="skill_stealth"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_search" name="spec_search"><label for="spec_search"></label></div><label class="skill-name-label">搜索</label><div class="skill-ranks" id="skill_search"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_explore" name="spec_explore"><label for="spec_explore"></label></div><label class="skill-name-label">探索</label><div class="skill-ranks" id="skill_explore"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_riddle" name="spec_riddle"><label for="spec_riddle"></label></div><label class="skill-name-label">暗语</label><div class="skill-ranks" id="skill_riddle"></div></div>
                <div class="skill-item"><div class="specialization-container"><input type="checkbox" id="spec_lore" name="spec_lore"><label for="spec_lore"></label></div><label class="skill-name-label">学识</label><div class="skill-ranks" id="skill_lore"></div></div>
            </div>
        </div>

        <div class="combat-features-section">
            <div class="combat-proficiencies">
                <h2>战斗熟练</h2>
                <div class="skill-item"><label>斧</label><div class="skill-ranks" id="prof_axes"></div></div>
                <div class="skill-item"><label>弓</label><div class="skill-ranks" id="prof_bows"></div></div>
                <div class="skill-item"><label>矛</label><div class="skill-ranks" id="prof_spears"></div></div>
                <div class="skill-item"><label>剑</label><div class="skill-ranks" id="prof_swords"></div></div>
            </div>

            <div class="feature-box">
                <h2 class="feature-title-bar">
                    <span class="feature-title-text">英勇</span>
                    <span class="feature-title-input">
                        <label for="valour" class="visually-hidden">英勇</label>
                        <input type="number" id="valour" name="valour" min="0" value="0">
                    </span>
                </h2>
                <div id="rewards_container">
                </div>
            </div>

            <div class="feature-box">
                <h2 class="feature-title-bar">
                    <span class="feature-title-text">智慧</span>
                    <span class="feature-title-input">
                        <label for="wisdom" class="visually-hidden">智慧</label>
                        <input type="number" id="wisdom" name="wisdom" value="0">
                    </span>
                </h2>
                <div id="virtues_container">
                </div>
            </div>
        </div>


        <div class="gear-section">
            <div class="gear-table gear-table-wide">
                <table>
                    <thead><tr><th>作战装备</th><th>伤害值</th><th>致伤值</th><th>负重</th><th>备注</th><th>操作</th></tr></thead>
                    <tbody id="combat_gear_body"></tbody>
                </table>
                <div class="gear-controls">
                    <button type="button" id="add_combat_gear_btn">+ 添加一行</button>
                </div>
            </div>
            <div class="gear-table protective-gear-table">
                <table>
                    <thead><tr><th>护具</th><th>防护</th><th>负重</th></tr></thead>
                    <tbody id="protective_gear_body">
                        <tr id="armor_slot">
                            <td><input type="text" data-key="name" readonly placeholder="点击选择护甲"></td>
                            <td><input type="text" data-key="value" class="short-input" readonly></td>
                            <td><input type="number" data-key="load" class="short-input" readonly></td>
                        </tr>
                        <tr id="helmet_slot">
                            <td><input type="text" data-key="name" readonly placeholder="点击选择头盔"></td>
                            <td><input type="text" data-key="value" class="short-input" readonly></td>
                            <td><input type="number" data-key="load" class="short-input" readonly></td>
                        </tr>
                        <tr id="shield_slot">
                            <td><input type="text" data-key="name" readonly placeholder="点击选择盾牌"></td>
                            <td><input type="text" data-key="value" class="short-input" readonly></td>
                            <td><input type="number" data-key="load" class="short-input" readonly></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        </div>

        <div class="main-right">
            <div class="header-right">
                <div class="portrait-box">
                    <img id="portrait_preview" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNTAiIGhlaWdodD0iMjAwIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg4OCIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Ik0yMCAyMWE4IDggMCAwIDAtMTYgME0xMiAxM2E0IDQgMCAxIDAgMC04IDQgNCAwIDAgMCAwIDhaIi8+PC9zdmc+" alt="人物形象预览">
                    <div class="portrait-controls">
                        <label for="portrait_upload" class="custom-file-upload">选择文件</label>
                        <input type="file" id="portrait_upload" accept="image/*">
                    </div>
                </div>

                <div class="points-row">
                    <div class="info-item adventure-points"><label for="adventure_points">冒险点数</label><input type="number" id="adventure_points" name="adventure_points"></div>
                    <div class="info-item skill-points"><label for="skill_points">技能点数</label><input type="number" id="skill_points" name="skill_points"></div>
                    <div class="info-item fellowship-points"><label for="fellowship_points">同盟点数</label><input type="number" id="fellowship_points" name="fellowship_points"></div>
                </div>

                <div class="header-extra">
                    <div class="secondary-stats-container">
                         <div class="diamond-box diamond-box-small square-box-small">
                            <div class="diamond-content">
                                <div class="attr-tn"><label for="load_val">负重</label><input type="number" id="load_val" name="load_val" min="0" readonly></div>
                                <div class="attr-val"><label for="fatigue_val">劳顿值</label><input type="number" id="fatigue_val" name="fatigue_val" min="0" value="0"></div>
                                <div class="attr-derived">当前耐力:<input type="number" id="current_endurance" class="current-stat-input-diamond"></div>
                            </div>
                        </div>
                        <div class="diamond-box diamond-box-small square-box-small">
                            <div class="diamond-content">
                                <div class="attr-tn"><label for="shadow_val">魔影</label><input type="number" id="shadow_val" name="shadow_val" min="0" value="0"></div>
                                <div class="attr-val"><label for="shadow_scar_val">伤疤</label><input type="number" id="shadow_scar_val" name="shadow_scar_val" min="0" value="0"></div>
                                <div class="attr-derived">当前希望:<input type="number" id="current_hope" class="current-stat-input-diamond"></div>
                            </div>
                        </div>
                    </div>
                    <div class="info-item status-checks">
                        <label>状态</label>
                        <div class="status-checkbox-group">
                            <div><input type="checkbox" id="status_weary" name="status_weary"><label for="status_weary"> 疲惫</label></div>
                            <div><input type="checkbox" id="status_miserable" name="status_miserable"><label for="status_miserable"> 痛苦</label></div>
                            <div><input type="checkbox" id="status_wounded" name="status_wounded"><label for="status_wounded"> 重伤</label></div>
                        </div>
                    </div>
                    <div class="info-item wound-severity"><label for="wound_severity">受伤程度</label><input type="text" id="wound_severity" name="wound_severity"></div>
                    <div class="info-item travel-gear-item">
                        <label for="travel_gear">旅行装备</label>
                        <textarea id="travel_gear" name="travel_gear" rows="4"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div class="buttons-section">
            <button id="save-btn">导出角色信息</button>
            <button id="export-btn">导出为PDF/打印</button>
            <button id="load-btn">读取角色信息</button>
            <button id="reset-btn">重置人物卡</button>
        </div>
    </div>
</div>

<div id="combatGearModal" class="modal-overlay hidden">
    <div class="modal-content">
        <h2>添加作战装备</h2>
        <form id="combatGearForm">
            <div class="modal-form-item">
                <label for="modal_combat_preset">选择预设装备</label>
                <select id="modal_combat_preset">
                    <option value="">--自定义或选择一项--</option>
                </select>
            </div>
            <hr>
            <div class="modal-form-item">
                <label for="modal_combat_name">作战装备</label>
                <input type="text" id="modal_combat_name" required>
            </div>
            <div class="modal-form-item">
                <label for="modal_combat_damage">伤害值</label>
                <input type="text" id="modal_combat_damage">
            </div>
            <div class="modal-form-item">
                <label for="modal_combat_injury">致伤值</label>
                <input type="text" id="modal_combat_injury">
            </div>
            <div class="modal-form-item">
                <label for="modal_combat_load">负重</label>
                <input type="number" id="modal_combat_load">
            </div>
            <div class="modal-form-item">
                <label for="modal_combat_notes">备注</label>
                <input type="text" id="modal_combat_notes">
            </div>
            <div class="modal-buttons">
                <button type="submit">保存</button>
                <button type="button" id="cancel_combat_gear_btn">取消</button>
            </div>
        </form>
    </div>
</div>

<div id="protectiveGearModal" class="modal-overlay hidden">
    <div class="modal-content">
        <h2>添加防护装备</h2>
        <form id="protectiveGearForm">
            <div class="modal-form-item">
                <label for="modal_protective_preset">选择预设装备</label>
                <select id="modal_protective_preset">
                    <option value="">--自定义或选择一项--</option>
                </select>
            </div>
            <hr>
            <div class="modal-form-item">
                <label for="modal_protective_name">护具</label>
                <input type="text" id="modal_protective_name" required>
            </div>
            <div class="modal-form-item">
                <label for="modal_protective_value">防护</label>
                <input type="text" id="modal_protective_value">
            </div>
            <div class="modal-form-item">
                <label for="modal_protective_load">负重</label>
                <input type="number" id="modal_protective_load">
            </div>
            <div class="modal-form-item">
                <label for="modal_protective_notes">类型</label>
                <input type="text" id="modal_protective_notes">
            </div>
            <div class="modal-buttons">
                <button type="submit">保存</button>
                <button type="button" id="cancel_protective_gear_btn">取消</button>
            </div>
        </form>
    </div>
</div>

<div id="portraitCropModal" class="modal-overlay hidden">
    <div class="modal-content portrait-crop-modal">
        <h2>裁剪头像</h2>
        <div class="portrait-crop-area">
            <div class="portrait-crop-frame" id="portrait_crop_frame">
                <img id="portrait_crop_image" alt="头像裁剪预览">
            </div>
        </div>
        <div class="portrait-crop-controls">
            <label for="portrait_zoom">缩放</label>
            <input type="range" id="portrait_zoom" min="1" max="3" step="0.01" value="1">
        </div>
        <div class="modal-buttons">
            <button type="button" id="portrait_crop_confirm">保存</button>
            <button type="button" id="portrait_crop_cancel">取消</button>
        </div>
    </div>
</div>


    <script src="assets/js/data/traits.js" defer></script>
    <script src="assets/js/data/cultures.js" defer></script>
    <script src="assets/js/data/callings.js" defer></script>
    <script src="assets/js/data/rewards.js" defer></script>
    <script src="assets/js/data/virtues.js" defer></script>
    <script src="assets/js/data/gear.js" defer></script>
    <script src="assets/js/main.js" defer></script>

</body>
</html>
